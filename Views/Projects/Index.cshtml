@model IEnumerable<ProjectManagementApp.Models.Project>

@{
    ViewData["Title"] = "Projects";
}

<!-- Lagt till sidebar -->
<div class="container-fluid">
    <div class="row">
        <div class="col-md-2 border-end pt-4" style="min-height: 100vh;">
            <button class="w-100 mb-2" style="background-color: #d0ebff; color: #228be6; font-weight: 600; border: none; border-radius: 6px; padding: 8px 12px;">
                <i class="bi bi-folder2-open me-2"></i> Projects
            </button>
        </div>

        <div class="col-md-10 pt-4 px-4">
            <h2 class="mb-3 fw-bold">Projects</h2>

            <!-- Create knappen har flyttats till höger sida -->
            <div class="d-flex justify-content-end mb-3">
                <a asp-action="Create" class="btn text-white" style="background-color: #228be6;">Create New Project</a>
            </div>

            <ul class="nav nav-tabs mb-4">
                @{
                    var filter = Context.Request.Query["statusFilter"];
                }
                <li class="nav-item">
                    <a class="nav-link @(string.IsNullOrEmpty(filter) || filter == "All" ? "active text-white" : "")" style="background-color: @(filter == "All" || string.IsNullOrEmpty(filter) ? "#228be6" : "")"
                       asp-action="Index" asp-route-statusFilter="All">All</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link @(filter == "Not Started" ? "active text-white" : "")" style="background-color: @(filter == "Not Started" ? "#228be6" : "")"
                       asp-action="Index" asp-route-statusFilter="Not Started">Not Started</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link @(filter == "Ongoing" ? "active text-white" : "")" style="background-color: @(filter == "Ongoing" ? "#228be6" : "")"
                       asp-action="Index" asp-route-statusFilter="Ongoing">Ongoing</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link @(filter == "Completed" ? "active text-white" : "")" style="background-color: @(filter == "Completed" ? "#228be6" : "")"
                       asp-action="Index" asp-route-statusFilter="Completed">Completed</a>
                </li>
            </ul>

            <div class="row">
                @foreach (var project in Model)
                {
                    <div class="col-md-4 mb-4">
                        <!-- Jag har redesignat kortens dropdown meny -->
                        <div class="card shadow-sm position-relative" style="border-radius: 12px; aspect-ratio: 5 / 2;">
                            <div class="dropdown position-absolute top-0 end-0 m-2">
                                <a class="text-muted" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    <i class="bi bi-three-dots-vertical"></i>
                                </a>
                                <ul class="dropdown-menu dropdown-menu-end">
                                    <li><a class="dropdown-item" asp-action="Edit" asp-route-id="@project.Id">Edit</a></li>
                                    <li><a class="dropdown-item text-danger" asp-action="Delete" asp-route-id="@project.Id">Delete</a></li>
                                </ul>
                            </div>

                            <div class="card-body d-flex flex-column justify-content-between">
                                <div>
                                    <h5 class="card-title fw-bold mb-1">@project.Name</h5>
                                    <p class="text-muted mb-3" style="font-size: 0.9rem;">@project.Company</p>
                                    <p style="font-weight: 600; font-size: 0.85rem;">@project.Description</p>
                                </div>

                                <p class="mt-3">
                                    <strong>Status:</strong>
                                    <span class="badge @(GetStatusClass(project.Status))">@project.Status</span>
                                </p>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

@functions {
    public string GetStatusClass(string status)
    {
        return status switch
        {
            "Not Started" => "bg-danger text-white",
            "Ongoing" => "bg-warning text-dark",
            "Completed" => "bg-success text-white",
            _ => "bg-secondary text-white"
        };
    }
}